<div class="page">
  <h1>My Groceries</h1>

  <form
    class="add-form"
    [formGroup]="addForm"
    (ngSubmit)="addItem()"
    novalidate
  >
    <div>
      <input type="text" placeholder="Item name" formControlName="name" />
      @if (addForm.controls.name.touched && addForm.controls.name.errors?.['required']) {
        <small class="error">Item name is required</small>
      }
      @if (addForm.controls.name.errors?.['duplicateName']) {
        <small class="error">An item with this name already exists</small>
      }
    </div>

    <div>
      <input type="number" min="1" placeholder="Quantity" formControlName="quantity" />
    </div>

    <div>
      <input type="text" placeholder="Image URL (optional)" formControlName="image" />
    </div>

    <button type="submit" [disabled]="addForm.invalid">
      Add Grocery
    </button>
  </form>

  @if (groceryService.groceries().length > 0) {
    <div class="grid">
      @for (g of groceryService.groceries(); track g.id) {
        <app-grocery-card
          [item]="g"
          (view)="viewDetail($event)"
          (delete)="deleteItem($event)">
        </app-grocery-card>
      }
    </div>
  } @else {
    <p>No groceries yet.</p>
  }
</div>
